<div class="dialog-header">
  <button mat-dialog-close>
    <i class="fa fa-close"></i>
  </button>
  <span>בקשה חדשה</span>
</div>
<form #form="ngForm">
  <div class="row mt-5 mb-3">
    <mat-checkbox class="col-5" name="has_clearing_employer" [(ngModel)]="hasClearingEmployer">כלל העובדים</mat-checkbox>
  </div>
  <div class="row col-12" [@fade]="hasClearingEmployer ? 'inactive' : 'active' ">
    <bd-select [items]="employees"
               placeholder="בחר עובד*" name="employee"
               #employeesModel="ngModel" ngModel
               [required]="!hasClearingEmployer"
               (serverFilter) = "filter($event, 'employee')"
               (onScroll)="checkLoadEmployees($event)"
               [clientSideSearch]="false"></bd-select>
    <p class="alert alert-danger" [@fade]="form.submitted && employeesModel.errors ? 'active' : 'inactive'">יש לבחור עובד.</p>
  </div>
  <div class="row  mt-4">
    <div class="col-5">
      <bd-select [items]="data.companies" placeholder="חברה מנהלת*" name="company" #companyModel="ngModel" ngModel  required ></bd-select>
      <p class="alert alert-danger" [@fade]="form.submitted && companyModel.errors ? 'active' : 'inactive'">יש לבחור חברה מנהלת.</p>
    </div>
  </div>

  <div class="row">
    <mat-form-field class="col-6">
      <input matInput  [max]="maxDateTo" class="pointer" (click)="dateFrom.open()"  [matDatepicker]="dateFrom"
             placeholder="מתאריך" name="dateFrom" ngModel readonly required (dateChange)="valueDateChange($event.value,'dateFrom')">
      <mat-datepicker-toggle matSuffix [for]="dateFrom"></mat-datepicker-toggle>
      <mat-datepicker #dateFrom></mat-datepicker>
      <mat-error>שדה חובה.</mat-error>
    </mat-form-field>

    <mat-form-field class="col-6">
      <input matInput  [min]="minDateFrom" class="pointer" (click)="dateTo.open()"  [matDatepicker]="dateTo"
             placeholder="עד תאריך" name="dateTo" ngModel readonly required (dateChange)="valueDateChange($event.value,'dateTo')">
      <mat-datepicker-toggle matSuffix [for]="dateTo"></mat-datepicker-toggle>
      <mat-datepicker #dateTo></mat-datepicker>
      <mat-error>שדה חובה.</mat-error>
    </mat-form-field>
  </div>

  <div class="form-group">
    <label for="comment">הערות:</label>
    <textarea class="form-control" rows="5" id="comment" name="comments"  ngModel></textarea>
  </div>

  <input type="hidden"  name="departmentID" [ngModel]="data.departmentId">

  <p class="alert alert-danger" [@fade]="hasServerError ? 'active' : 'inactive'">{{message}}</p>
  <div mat-dialog-actions class="justify-content-center">
    <button class="btn blue-btn" (click)="submit(form)">שמור</button>
  </div>
</form>
