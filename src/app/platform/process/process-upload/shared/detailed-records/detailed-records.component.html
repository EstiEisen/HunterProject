
<div class="d-flex align-content-between w-75">
    <mat-form-field class="w-50  mr-4">
      <mat-select name="employee" placeholder="בחר עובד" [(ngModel)]="selectedEmployee">
        <mat-option *ngFor="let type of processType" [value]="type.id">{{ type.name }}</mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field class="w-50  mr-4">
        <mat-select name="cashBox" placeholder="בחר קופה" [(ngModel)]="selectedCashBox">
          <mat-option *ngFor="let type of processType" [value]="type.id">{{ type.name }}</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field class="w-50  mr-4">
      <mat-select name="filter" placeholder="בחר סינון" [(ngModel)]="selectedFilter">
        <mat-option *ngFor="let type of processType" [value]="type.id">{{ type.name }}</mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field class="w-50 mr-4">
      <input type="text" name="search" matInput placeholder="חיפוש" [(ngModel)]="searchParams">
    </mat-form-field>
  <div>
    <button mat-button [matMenuTriggerFor]="menu" class="btn blue-btn  mr-5 mt-2">פעולות</button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item (click)="openUpdatePayDateDialog('', -1)">עדכון תאריך תשלום</button>
      <button mat-menu-item (click)=openWarningMessageComponentDialog(false)>מחיקת שורה</button>
      <button mat-menu-item (click)=openDialogAttachReference()>צירוף אסמכתא</button>
      <button mat-menu-item (click)=openWarningMessageComponentDialog(true)>הפוך ללא רלוונטי</button>
    </mat-menu>
  </div>
</div>
<!--[matTooltip]="'מיין לפי ' + header.label"-->
<table class="table mt-3 data-table">
  <thead>
  <tr class="table-headers">
    <th *ngIf="items.length > 0">
      <mat-checkbox (change)="checkAll($event.checked)" [ngModel]="isCheckAll"></mat-checkbox>
    </th>
    <th *ngFor="let header of headers" (click)="sort(header)">
      <span class="pointer" >{{ header.label }}</span>
      <i [class]="getHeaderIconClass()" *ngIf="orderCriteria.orderBy === header.column"></i>
    </th>
  </tr>
  </thead>
  <tbody>
    <ng-container *ngIf="!isSearching">
      <tr *ngFor="let item of paginatedItems" class="pointer" [ngClass]="{ 'checked': item.isChecked }">
        <td>
          <mat-checkbox (change)="checkItem(item, $event.checked)" [checked]="isCheckAll"></mat-checkbox>
        </td>
        <td>{{ item.created_at | date: 'dd/MM/yy' }}</td>
        <td>{{ item.updated_at | date: 'dd/MM/yy' }}</td>
        <td>{{ item.username }}</td>
        <td>{{ item.employer_name }}</td>
        <td>{{ item.department_name }}</td>
        <td>{{ item.employee_name }}</td>
        <td>{{ item.personal_id }}</td>
        <td>{{ item.company_name }}</td>
        <td>{{ productTypes[item.product_type] }}</td>
        <td>{{ item.validity_date | date: 'dd/MM/yy' }}</td>
        <td>{{ sendingMethods[item.sending_method] }}</td>
        <td>
          <p class="mb-0">{{ statuses[item.status]  }}</p>
          <img src="/assets/img/icons/details_grey.png" (click)="openErrorMessageDialog(item)" class="mt-1"
               *ngIf=" item.status === 'feedback_a' || item.status === 'feedback_b' ?
             (item.feedback_level === 'record' && (item.code_error !== null ||
             (item.error_details !== '' && item.error_details !== null)) ||
             (item.answerings_manufacturer !== null && item.answerings_manufacturer !== ''))
             ||
             (item.feedback_level === 'file'  && item.code_error_file !== null  &&
              item.code_error_file !== 'accepting_valid_file' ) : false" >
        </td>
        <td>
          <img src="/assets/img/icons/forward_green.png" (click)="openSendToDialog(item)">
        </td>
        <td>
          <span class="grey-circle" (click)="openInquiriesDialog(item)">{{ item.inquiry_count }}</span>
        </td>
        <td>
          <img src="/assets/img/icons/chat_bubble_grey.png" (click)="openCommentsDialog(item)">
        </td>
        <td>
          <span *ngIf="item.status !== 'closed'">טרם</span>
          <i class="fa fa-download fa-lg ml-2" (click)="PdfFile(item.id, 'download')" *ngIf="item.status === 'closed'"></i>
          <i class="fa fa-eye fa-lg" (click)="PdfFile(item.id, 'show')" *ngIf="item.status === 'closed'"></i>
        </td>
        <td>
          <img src="/assets/img/icons/details_grey.png" (click)="openDetailsDialog(item)">
        </td>
        <td>
          <img [src]="getValidityImage(item)" class="row-image" >
        </td>

      </tr>
    </ng-container>
    <tr *ngIf="!isSearching && items.length === 0">
      <td colspan="19" class="text-center bold">טבלת הבקשות ריקה.</td>
    </tr>
    </tbody>
  </table>
  <!--<app-pagination [data]="paginationData" *ngIf="items.length > 0"></app-pagination>-->
