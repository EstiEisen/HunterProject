<form #form="ngForm" class="mt-5">
  <div class="float-left">
    <button class="btn blue-btn" (click)="setPage()">
      הנני לאשר תשלום בפועל
    </button>
  </div>

  <h5 class="bold">אישור וצירוף אסמכתא</h5>
  <p class="f-12 mb-2 mt-4">במסך זה הנך נדרש לצרף אסמכתא של העברה בנקאית/פרטי המסב ולציין את התאריך של ביצוע התשלום בפועל.</p>
  <p class="border-bottom f-12 bold grey-color mt-lg-4 w-25">פרטי התשלומים </p>

  <div class="d-flex mt-5 align-items-center">
    <span class="f-14">לצפייה בחשבון משלם של המעסיק</span>
    <span class="f-14 bold mr-1">לחץ כאן</span>
    <i class="fa fa-angle-left fa-circle-me mr-3" *ngIf="hasShowBank" (click)="hasShowBank = !hasShowBank"></i>
    <i class="fa fa-angle-right fa-circle-me mr-3" *ngIf="!hasShowBank" (click)="hasShowBank = !hasShowBank"></i>
  </div>

  <div [@fade]="hasShowBank ? 'active' : 'inactive'">
    <p class="border-bottom border-margin f-14 bold ">חשבון בנק משלם</p>
    <div id="accounts" class="border-bottom mb-lg-3 border-margin" >
      <div class="d-flex align-items-center">
        <div class="d-flex align-items-center" [ngClass]="{'disabledInput' : !isEdit}">
          <div class="bd-select-container">
            <bd-select name="bank_id"  [items]="banks" #bankIDSelect="ngModel" [(ngModel)]="department.bank_account_deposit.bank_id" placeholder="בחר בנק" (onSelect)="selectedBankBranch()" required></bd-select>
            <mat-error [@fade]="bankIDSelect.errors && form.submitted ? 'active' : 'inactive'">שדה חובה. </mat-error>
          </div>
          <div class="mx-3 bd-select-container">
            <bd-select name="branch_id"  [items]="bankBranchesDeposit" #branchIDSelect="ngModel" [(ngModel)]="department.bank_account_deposit.branch_id"  placeholder="בחר סניף" required></bd-select>
            <mat-error [@fade]="branchIDSelect.errors && form.submitted ? 'active' : 'inactive'">שדה חובה. </mat-error>
          </div>
          <mat-form-field>
            <input matInput type="text" name="number" placeholder="מס' חשבון" [(ngModel)]="department.bank_account_deposit.number" maxlength="9" pattern="^\d{5,9}$" required>
            <mat-error>יש להקיש מעל 5 ספרות.</mat-error>
          </mat-form-field>
        </div>
        <div>
          <img src="/assets/img/icons/edit_grey.png" class="row-image" (click)="isEdit = true">
        </div>
        <i class="fa fa-copy fa-2x pointer blue-color mr-3" title="העתק פרטי חשבון"  (click)="copyBankRow()" *ngIf="validCopy()"></i>
      </div>
    </div>

    <p class="border-bottom border-margin f-14 bold">חשבון בנק להחזר כספים</p>
    <div id="accountsWithdrawal" class="border-bottom border-margin">
      <div class="d-flex align-items-center">
        <div class="d-flex align-items-center" [ngClass]="{'disabledInput' : !isEditWithdrawal}">
          <div class="bd-select-container">
            <bd-select name="bank_id_withdrawal"  [items]="banks" #bankIDWithdrawalSelect="ngModel" [(ngModel)]="department.bank_account_withdrawal.bank_id" placeholder="בחר בנק" (onSelect)="selectedBankBranch('Withdrawal')" required></bd-select>
            <mat-error [@fade]="bankIDWithdrawalSelect.errors && form.submitted ? 'active' : 'inactive'">שדה חובה. </mat-error>
          </div>
          <div class="mx-3 bd-select-container">
            <bd-select name="branch_id_withdrawal"  [items]="bankBranchesWithdrawal" #branchIDWithdrawalSelect="ngModel" [(ngModel)]="department.bank_account_withdrawal.branch_id"  placeholder="בחר סניף" required></bd-select>
            <mat-error [@fade]="branchIDWithdrawalSelect.errors && form.submitted ? 'active' : 'inactive'">שדה חובה. </mat-error>
          </div>
          <mat-form-field>
            <input matInput type="text" name="number_withdrawal" placeholder="מס' חשבון" [(ngModel)]="department.bank_account_withdrawal.number" maxlength="9" pattern="^\d{5,9}$" required>
            <mat-error>יש להקיש מעל 5 ספרות.</mat-error>
          </mat-form-field>
        </div>
        <div>
          <img src="/assets/img/icons/edit_grey.png"  class="row-image" (click)="isEditWithdrawal = true">
        </div>
      </div>
    </div>
    <button class="btn blue-btn ml-1 mt-1" (click)="saveBank(form)"> שמור </button>

  </div>

  <mat-checkbox  [(ngModel)]="valid" name="checkConfirm">
    <div class="text-wrap text-right mt-4">
      <p class="f-12">הנני מאשר כי פרטי התשלום המוצגים הלאה נבדקו מול תוכנת השכר והנם תקינים.
        בשידור לקופות הקבצים יועברו על פי הנתונים הקיימים ופעולה זו אינה ניתנת לביטול.</p>
    </div>
  </mat-checkbox>

  <div class="d-flex mt-1 f-14 bold">
    <span class="f-14 bold ml-1">  סכום לתשלום: </span>
    {{ sum  | number: '1.2-2'}}
    <button class="btn-design pointer mr-4" (click)="attachmentReference()">טען אסמכתא<span class="blue-color pr-4">+</span>
    </button>
  </div>

  <div class="d-flex mt-1">
    <span class="f-14 bold line-height-4point ml-1">תאריך ותשלום ערך:</span>
    <mat-form-field>
      <input matInput class="pointer" (click)="datePickerRequest.open()" [(ngModel)]="date" [max]="today"   [matDatepicker]="datePickerRequest"
             placeholder="בחר תאריך" name="dateRequest" readonly>
      <mat-datepicker-toggle matSuffix [for]="datePickerRequest"></mat-datepicker-toggle>
      <mat-datepicker #datePickerRequest></mat-datepicker>
    </mat-form-field>
    <img src="/assets/img/icons/save icon.svg" (click)="date ? save(): false"/>
  </div>


  <div class="d-flex mt-5 align-items-center">
    <span class="f-14">לצפייה ואישורי העברות</span>
    <span class="f-14 bold mr-1">לחץ כאן</span>
    <i class="fa fa-angle-left fa-circle-me mr-3" *ngIf="hasShow" (click)="hasShow = !hasShow"></i>
    <i class="fa fa-angle-right fa-circle-me mr-3" *ngIf="!hasShow" (click)="hasShow = !hasShow"></i>
  </div>

  <div [@fade]="hasShow ? 'active' : 'inactive'">
      <router-outlet></router-outlet>
  </div>
</form>
