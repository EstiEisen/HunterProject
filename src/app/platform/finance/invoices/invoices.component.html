
<app-data-table tableName="חשבונות חייבים" [columns]="columns" (fetchItems)="fetchItems()" [hasCheckColumn]="true" [hasActionsHeader]="false">
  <div class="table-header">
    <div class="row mt-4 mr-1">
      <div class="float-left">
        <button class="btn blue-btn" (click)="openFinanceExcelDialog()">אקסל מעסיקים</button>
        <button class="btn blue-btn mr-2" (click)="openProactiveInvoice()">חשבון יזום</button>
        <button class="btn blue-btn mr-2" (click)="openManualInvoice()">חשבון ידני</button>
      </div>
      <div class="ml-3 d-flex mr-auto">
        <button [matMenuTriggerFor]="menu" class="btn blue-btn">פעולות</button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item (click)="deleteInvoices()">מחיקת חשבוניות</button>
        </mat-menu>
      </div>
    </div>
  </div>
  <tr *ngFor="let item of dataTable.items" class="pointer">
    <td class="check-column">
      <mat-checkbox (change)="dataTable.checkItem(item, $event.checked)" [checked]="item.checked"></mat-checkbox>
    </td>
    <td>{{ item.employer_financial_details.employer.name}}</td>
    <!--matTooltip={{item.errorDescription}}-->
    <td >{{ item.green_invoice_document !== null ? item.green_invoice_document.number : ''}}</td>
    <td>{{ item.total_amount }}</td>
    <td>{{ item.ids_count }}</td>
    <td>{{ item.for_month  | date: 'MM/yy' }}</td>
    <td>{{ item.created_at  | date: 'dd/MM/yy' }}</td>
    <td>{{ item.last_payment_date  | date: 'dd/MM/yy'  }}</td>
    <td>חשבון עסקה</td>
    <!--<td [matTooltip]="item.green_invoice_document !== null &&  item.green_invoice_document.errorDescription !== '' ? item.green_invoice_document.errorDescription : ''">-->
      <!--{{ invoice_all_status[item.status] }}-->
    <!--</td>-->
    <td class="select-status">
      <!--<mat-select [(ngModel)]="item.status" [value]="item.status" (selectionChange)="setInvoiceStatus(item.id, item.status)" required>-->
        <!--<mat-option [value]="invoice_status.waiting_for_payment">ממתין לתשלום</mat-option>-->
        <!--<mat-option [value]="invoice_status.canceled">בוטל</mat-option>-->
        <!--<mat-option [value]="invoice_status.green_invoice_error">לא נשלח לחשבונית ירוקה</mat-option>-->
        <!--<mat-option [value]="invoice_status.green_invoice_valid">נשלח חשבונית ירוקה</mat-option>-->
        <!--<mat-option [value]="invoice_status.paid">שולם</mat-option>-->
      <!--</mat-select>-->
      <mat-select name="status" placeholder="" [(ngModel)]="item.status" (selectionChange)="setInvoiceStatus(item.id, item.status)" required>
        <mat-option *ngFor="let st of status" [value]="st.id">{{ st.name }}</mat-option>
      </mat-select>
      <!--<bd-select [items]="status" placeholder="" #statusSelect="ngModel" name="status"-->
                 <!--[(ngModel)]="item.status" (onselect)="setInvoiceStatus(item.id, item.status)"-->
                 <!--required></bd-select>-->
    </td>
    <td>
      <i class="fa fa-eye fa-lg" (click)="ShowRemarks(item)" *ngIf="item.status !== 'closed'"></i>
      <i class="fa fa-eye fa-lg" (click)="ShowRemarks(item)" *ngIf="item.status === 'closed'"></i>
    </td>
    <td *ngIf="item.description != ''">
      <i class="fa fa-download fa-lg ml-2" title="פירוט עובדים בחשבונית" (click)="downloadEmployeesExcel(item.id)" ></i>
    </td>
  </tr>
</app-data-table>
