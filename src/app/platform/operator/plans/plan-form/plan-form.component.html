<div class="mr-5 px-4">
  <div id="wrapper" class="row">
    <form #form="ngForm">
      <h3 class="mb-5">הגדרות תוכנית עבודה</h3>
      <mat-form-field class="w-75 mb-3">
        <input matInput type="text" name="name" [(ngModel)]="plan.name" placeholder="שם התוכנית" #name="ngModel">
        <!--<mat-error *ngIf="name.errors && f.submitted">יש לבחור שם לתוכנית.</mat-error>-->
      </mat-form-field>
      <div class="w-75 mb-3">
        <bd-select name="users" [items]="operators" placeholder="מתפעלים" [(ngModel)]="plan.users" [multiple]="true" required></bd-select>
      </div>
      <p class="h5">בחר טווח שעות עבודת התוכנית *</p>
      <div id="time" class="row mb-3">
        <mat-form-field>
          <mat-select [(ngModel)]="plan.start_time" name="start_time" placeholder="שעה התחלה" required>
            <mat-option *ngFor="let timestamp of timestamps" [value]="timestamp">{{ timestamp }}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="mr-3">
          <mat-select [(ngModel)]="plan.end_time" name="endTime" placeholder="שעת סיום" required>
            <mat-option *ngFor="let timestamp of timestamps" [value]="timestamp">{{ timestamp }}</mat-option>
            <!--<mat-error *ngIf="checktime(plan.start_time, plan.end_time)">תאריך סיום לא יכול להיות קטן מתאריך התחלה</mat-error>-->
          </mat-select>
        </mat-form-field>
      </div>
      <!--<mat-form-field class="w-75 mb-3">-->
        <!--<mat-select [(ngModel)]="plan.type" name="type" #type="ngModel" placeholder="סוג התוכנית" required>-->
        <!--<mat-option *ngFor="let type of types" [value]="type.id">{{ type.name }}</mat-option>-->
        <!--</mat-select>-->
        <!--&lt;!&ndash;<mat-select [(ngModel)]="plan.type" name="type" #type="ngModel" placeholder="סוג התוכנית" required>&ndash;&gt;-->
          <!--&lt;!&ndash;<mat-option *ngFor="let type of types" [value]="type.id">{{ type.name }}</mat-option>&ndash;&gt;-->
        <!--&lt;!&ndash;</mat-select>&ndash;&gt;-->
        <!--&lt;!&ndash;<mat-error *ngIf="type.errors && f.submitted">יש לבחור סוג לתוכנית.</mat-error>&ndash;&gt;-->
      <!--</mat-form-field>-->
      <!--<mat-form-field class="w-75 mb-3">-->
        <!--<mat-select [(ngModel)]="plan.sub_type" name="sub_type" [value]="type.sub_type" #sub_type="ngModel" placeholder="תוכנית משנה" required>-->
          <!--<mat-option *ngFor="let type of types" [value]="type.id">{{ type.name }}</mat-option>-->
        <!--</mat-select>-->
        <!--&lt;!&ndash;<mat-error *ngIf="sub_type.errors && f.submitted">יש לבחור חיובי או שלילי.</mat-error>&ndash;&gt;-->
      <!--</mat-form-field>-->
      <!--<mat-form-field class="w-75 mb-3">-->
        <!--<input matInput type="text" name="name" [(ngModel)]="plan.name" placeholder="שם התוכנית" #name="ngModel">-->
        <!--&lt;!&ndash;<mat-error *ngIf="name.errors && f.submitted">יש לבחור שם לתוכנית.</mat-error>&ndash;&gt;-->
      <!--</mat-form-field>-->

      <!--<p class="h5">בחר טווח חודשי שכר *</p>-->
      <!--<div class="d-flex w-75 mb-3">-->
        <!--<mat-form-field class="w-50 ml-3">-->
          <!--<input matInput [matDatepicker]="salary_start_date" [(ngModel)]="plan.salary_start_date" name="salary_start_date" placeholder="חודש התחלה" required>-->
          <!--<mat-datepicker-toggle matSuffix [for]="salary_start_date"></mat-datepicker-toggle>-->
          <!--<mat-datepicker #salary_start_date [startView]="'year'"></mat-datepicker>-->
        <!--</mat-form-field>-->
        <!--<mat-form-field class="w-50">-->
          <!--<input matInput [matDatepicker]="salary_end_date" [(ngModel)]="plan.salary_end_date" name="salary_end_date" placeholder="חודש סיום" required>-->
          <!--<mat-datepicker-toggle matSuffix [for]="salary_end_date"></mat-datepicker-toggle>-->
          <!--<mat-datepicker #salary_end_date [startView]="'year'"></mat-datepicker>-->
        <!--</mat-form-field>-->
      <!--</div>-->

      <div class="d-flex justify-content-center fixed-bottom">
        <img src="/assets/img/spinner.svg" class="mr-auto ml-auto mb-3" *ngIf="isSubmitting">
      </div>
      <p class="alert alert-danger d-flex align-items-center" *ngIf="isSubmitFailed && !isSubmitting">
        <i class="fa fa-exclamation-circle ml-1"></i>
        <span> השמירה נכשלה, אנא נסה שנית.</span>
      </p>

    </form>
    <div id="taskPrioritization" class="col-md mr-lg-5">
      <p class="h5 mt-5 mb-3 text-center bold">סדר תיעדוף משימות</p>
      <!--<div cdkDropList #todoList="cdkDropList"-->
        <!--[cdkDropListData]="categoriesData" class="example-list" (cdkDropListDropped)="drop($event)">-->
        <!--<div class="example-box"  *ngFor="let item of categoriesData; let index = index" cdkDrag >{{ showLabel ? categoryLabel[item.name] : item.name}}-->
        <!--</div>-->
      <!--</div>-->
      <div class="d-flex align-items-center" *ngFor="let row of plan.categories;  let last = last; let index = index">
        <p>{{ index + 1 + '.' }} </p>
        <div class="d-flex align-items-center mb-lg-3">
          <div class="bd-select-container">
            <bd-select name="type_id" [items]="types" #typeIDSelect="ngModel" [(ngModel)]="row.type.type.name" placeholder="סוג תוכנית" (onSelect)="selectedSubType(row.type)" required></bd-select>
            <!--<mat-error [@fade]="typeIDSelect.errors && form.submitted ? 'active' : 'inactive'">שדה חובה. </mat-error>-->
          </div>
          <div class="mx-3 bd-select-container">
            <bd-select name="subType_id"  [items]="subTypes" #subTypeIDSelect="ngModel" [(ngModel)]="row.type.name"  placeholder="תוכנית משנה" required></bd-select>
            <!--<mat-error [@fade]="subTypeIDSelect.errors && form.submitted ? 'active' : 'inactive'">שדה חובה. </mat-error>-->
          </div>
        </div>
        <mat-form-field class="w-25 mb-3 mr-3">
          <input matInput type="text" [name]="'amount' + index" [(ngModel)]="row.tasks_amount" placeholder="כמות" required>
        </mat-form-field>
        <div class="d-flex w-50 mb-3">
          <mat-form-field class="ml-3 mr-3">
          <input matInput [matDatepicker]="salary_start_date" [(ngModel)]="row.salary_date_start" name="salary_start_date" placeholder="חודש התחלה" [ngModelOptions]="{timezone: ''}" required>
          <mat-datepicker-toggle matSuffix [for]="salary_start_date"></mat-datepicker-toggle>
          <mat-datepicker #salary_start_date [startView]="'year'"></mat-datepicker>
          </mat-form-field>
          <mat-form-field>
          <input matInput [matDatepicker]="salary_end_date" [(ngModel)]="row.salary_date_end" name="salary_end_date" placeholder="חודש סיום" [ngModelOptions]="{timezone: ''}" required>
          <mat-datepicker-toggle matSuffix [for]="salary_end_date"></mat-datepicker-toggle>
          <mat-datepicker #salary_end_date [startView]="'year'"></mat-datepicker>
          </mat-form-field>
        </div>
        <i class="fa fa-plus-circle fa-2x pointer blue-color" title="הוספה" (click)="addPlanRow()" *ngIf="last && index < 7"></i>
        <i class="fa fa-close fa-2x pointer blue-color" title="מחיקה" (click)="deletePlanRow(index)" *ngIf="index != 0"></i>
      </div>

    </div>

    <!--<div class="mt-3">-->
      <!--&lt;!&ndash;<button *ngIf="!(plan.type && plan.sub_type && plan.operators &&&ndash;&gt;-->
      <!--&lt;!&ndash;plan.start_time && plan.end_time && plan.salary_start_date &&&ndash;&gt;-->
      <!--&lt;!&ndash;plan.salary_end_date )" (click)="submit(form)" type="submit" class="grey-btn" disabled>{{ plan.id ? 'עדכן תוכנית' : 'צור תוכנית' }}</button>&ndash;&gt;-->
      <!--<button (click)="submit(form)" type="submit" class="btn blue-btn">{{ plan.id ? 'עדכן תוכנית' : 'צור תוכנית' }}</button>-->
    <!--</div>-->
    <div class="d-flex mr-3">
      <a (click)="previous()">
        <p class="f-14 blue-color">
          <i class="fa fa-angle-right ml-1 ml-lg-2"></i>
          <span>חזור</span>
        </p>
      </a>
    </div>

  </div>
  <div class="d-flex justify-content-end">
    <button class="btn blue-btn mt-3 mb-5" (click)="submit(form)">{{ plan.id ? 'עדכן תוכנית' : 'צור תוכנית' }}</button>
  </div>
</div>

