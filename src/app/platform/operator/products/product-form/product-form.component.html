<div class="mr-5 px-4">
  <form #form="ngForm">
    <div class="row mt-3 mb-3">
      <div class="bd-select-container w-25 mr-3">
        <bd-select  [items]="entities" name="entity_id" #entityIDSelect="ngModel"
                    [(ngModel)]="product.company_id" placeholder="חברה מנהלת"
                    required [error]="entityIDSelect.errors && form.submitted"></bd-select>
      </div>
    </div>
    <div style="margin-right: 700px">
      <button class="btn blue-btn" (click)="openRedirectedProductDialog(product.id)">קופות שנותבו</button>
    </div>
    <div class="d-flex align-items-center mb-3">
      <mat-form-field>
        <input matInput type="text" name="name" [(ngModel)]="product.name" placeholder="שם קופה" required>
      </mat-form-field>
      <mat-form-field class="mr-3">
        <input matInput type="text" name="code" [(ngModel)]="product.code" placeholder="מספר קופה" required>
      </mat-form-field>
      <div class="bd-select-container mr-3">
          <bd-select [name]="types"  [items]="types" #typeSelect="ngModel" [(ngModel)]="product.type"
                     placeholder="סוג מוצר" [error]="typeSelect.errors && form.submitted" required></bd-select>
        </div>
    </div>
    <p class="border-bottom f-14 bold grey-color">בנקים</p>
    <div class="d-flex align-items-center mt-3" *ngFor="let ba of product.bank_account;  let last = last; let index = index">
      <div  class="d-flex align-items-center mt-3" *ngIf="ba.is_active || (ba.id == undefined)" >
      <div class="bd-select-container">
        <bd-select [name]="'bank_id' + index"
                   [items]="banks" #bankIDSelect="ngModel"
                   [(ngModel)]="ba.bank_id" placeholder="בחר בנק"
                   required
                   [error]="bankIDSelect.errors && form.submitted"></bd-select>
      </div>
      <div class="bd-select-container mr-3">
        <bd-select [name]="'branch_id' + index"
                   [items]="selectedBankBranch(index)"
                   #branchIDSelect="ngModel"
                   [(ngModel)]="ba.branch_id"
                   placeholder="בחר סניף" required
                   [error]="branchIDSelect.errors && form.submitted"></bd-select>
      </div>
      <mat-form-field class="mr-3">
        <input matInput type="text" [name]="'account_number' + index" [(ngModel)]="ba.account_number" placeholder="מס' חשבון" maxlength="8" pattern="^\d{5,8}$" required>
        <mat-error>יש להקיש מעל 5 ספרות.</mat-error>
      </mat-form-field>
      <mat-checkbox class="mx-3" [name]="'is_primary' + index" [(ngModel)]="ba.is_primary" (change)="primaryBankChecked(index, $event.checked)">ראשי</mat-checkbox>
      <i class="fa fa-close fa-2x pointer blue-color" title="מחיקה" (click)="deleteBankRow(index)" *ngIf="index != 0"></i>
      </div>
      <i class="fa fa-plus-circle fa-2x pointer blue-color" title="הוספה" (click)="addBankRow()" *ngIf="last"></i>
    </div>
    <div class="mt-3">
      <button class="btn blue-btn" type="submit" (click)="submit(form)">שמירה</button>
    </div>
  </form>
</div>
