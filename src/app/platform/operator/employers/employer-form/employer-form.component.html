<div class="mr-5 px-4" *ngIf="employer">
  <div class="row">
    <p class="h5 bold py-3">כרטיס מעסיק <span class="h6 py-3">- {{ this.employer.id }} </span>  </p>
  <div class="d-flex mr-auto">
    <a (click)="previous()">
      <p class="f-14 blue-color">
        <i class="fa fa-angle-right ml-1 ml-lg-2"></i>
        <span>חזור</span>
      </p>
    </a>
  </div>
  </div>
  <div class="d-flex mt-5" [ngClass]="{ 'disabledDiv': !permissionsType }">
    <form #form="ngForm" (ngSubmit)="submit(form)"  [formGroup]="employerForm">
      <div class="d-flex">
          <div class="mb-3">
              <mat-form-field>
                <input matInput type="text" [(ngModel)]="employer.name" placeholder="שם מעסיק"
                       (change)="saveChanges = true" formControlName="name">
              </mat-form-field>
              <mat-form-field class="mr-3">
                <input matInput type="text" [(ngModel)]="employer.identifier" placeholder="מספר ח.פ"  maxlength="9"
                       (change)="saveChanges = true" formControlName="identifier">
                <mat-error>יש להקיש 9 ספרות.</mat-error>
              </mat-form-field>
              <mat-form-field class="mr-3">
                <input matInput type="text" [(ngModel)]="employer.received_identifier" placeholder="מספר מזהה שולח"
                       (change)="saveChanges = true" formControlName="receivedIdentifier"  maxlength="9">
                <mat-error>יש להקיש 9 ספרות.</mat-error>
              </mat-form-field>
              <mat-form-field class="mr-3">
                <input matInput type="text" [(ngModel)]="employer.deduction_number" placeholder="מספר תיק ניכויים"
                       (change)="saveChanges = true" formControlName="deductionNumber">
              </mat-form-field>
            <div class="mr-1 d-inline-block bd-de">
             <bd-select [items]="identifierTypes" placeholder="סוג מזהה לשליחה"
                           [(ngModel)]="employer.sender_identifier_type" formControlName="identifierType" required
                           class="mr-3 d-inline-block bd-de" [error]="(employer.city_id == 0 ||
                            employer.sender_identifier_type == null) && form.submitted" required
                           (onSelect)="saveChanges = true"></bd-select>
            </div>
              <mat-form-field  class="mr-5">
                <input matInput placeholder="מספר מזהה לשליחה"  [(ngModel)]="employer.sender_identifier"
                       formControlName="senderIdentifier" maxlength="9" (change)="saveChanges = true">
                <mat-error>יש להקיש 9 ספרות.</mat-error>
              </mat-form-field>
            <div class="mr-4 d-inline-block bd-de">
              <bd-select [items]="cities" placeholder="עיר" [(ngModel)]="employer.city_id"  formControlName="city_id"
                         [error]="(employer.city_id == 0 ||
                            employer.city_id == null) && form.submitted" required
                         (onSelect)="saveChanges = true"></bd-select>
            </div>
            <mat-form-field  class="mr-4">
              <input matInput type="text" placeholder="כתובת" [(ngModel)]="employer.address"
                     (change)="saveChanges = true" formControlName="address">
            </mat-form-field>
          </div>
      </div>
      <div class="mt-4">
        <mat-form-field>
          <input matInput  placeholder="טלפון" [(ngModel)]="employer.phone"
                 (change)="saveChanges = true" formControlName="phone" maxlength="11" minlength="7">
        </mat-form-field>
        <div class="mr-3 d-inline-block bd-de">
          <bd-select [items]="projects" placeholder="פרוייקט"
                     [(ngModel)]="employer.project_id" formControlName="project" required
                     [error]="(employer.project_id == 0 ||
                              employer.project_id == null) && form.submitted" required
                     (onSelect)="saveChanges = true"></bd-select>
        </div>
        <div class="mr-4 d-inline-block bd-de"  *ngIf="operator">
            <bd-select  [items]="operators" placeholder="מנהל תיק"
                       [(ngModel)]="employer.operator.id" formControlName="operator" required
                       [error]="(employer.operator.id == 0 ||
                                employer.operator.id == null) && form.submitted" required
                       (onSelect)="saveChanges = true"></bd-select>
        </div>
        <div class="mr-4 d-inline-block bd-de" *ngIf="!operator">
          <bd-select  [items]="operators" placeholder="מנהל תיק"
                      [(ngModel)]="employer.operator" formControlName="operator" required
                      [error]="(employer.operator == 0 ||
                                employer.operator == null) && form.submitted" required
                      (onSelect)="saveChanges = true"></bd-select>
        </div>
        <div class="mr-4 d-inline-block bd-de">
          <bd-select [items]="statuses" placeholder="סטטוס"
                     [(ngModel)]="employer.status" formControlName="status" required
                     [error]="(employer.status == 0 ||
                              employer.status == null) && form.submitted" required
                     (onSelect)="saveChanges = true"></bd-select>
        </div>
        <div class="mr-4 d-inline-block bd-de">
            <bd-select [items]="paymentType" placeholder="סוג תשלום"
                       [(ngModel)]="employer.payment_type" formControlName="paymentType" required
                       [error]="(employer.payment_type == 0 ||
                                employer.payment_type == null) && form.submitted" required
                       (onSelect)="saveChanges = true"></bd-select>
        </div>

        <mat-form-field class="mr-4">
          <input matInput placeholder="קוד מוסד(5)"  [(ngModel)]="employer.institution_code_5"
                 [required]="employerForm.value.paymentType === 'masav'"
                 formControlName="institutionCode5" maxlength="5" (change)="saveChanges = true">
          <mat-error>שדה חובה</mat-error>
        </mat-form-field>
        <mat-form-field class="mr-3">
          <input matInput placeholder="קוד מוסד(8)"  [(ngModel)]="employer.institution_code_8"
                 [required]="employerForm.value.paymentType === 'masav'"
                 formControlName="institutionCode8" maxlength="8" (change)="saveChanges = true">
          <mat-error>שדה חובה</mat-error>
        </mat-form-field>
        <button [disabled]="!saveChanges" class="btn blue-btn mr-5" type="submit">שמור שינויים</button>
      </div>
    </form>
  </div>
  <div class="container-fluid">
    <header>
      <div id="mainMenu">
        <nav class="navbar navbar-toggleable-md navbar-light bg-faded">
          <div class="collapse navbar-collapse">
            <ul class="navbar-nav">
              <ng-container *ngFor="let link of headers">
                <li class="nav-item" *ngIf="!link.subMenuLinks" [ngClass]="{ 'active': link.url === activeUrl }"
                    [hidden]="userSession.isPermissions(link.subUrl)">
                  <a class="menu-link" [routerLink]="[link.url]">
                    <p>{{ link.label }}</p>
                  </a>
                </li>
                <li [matMenuTriggerFor]="subMenu" class="nav-item pointer"
                    [hidden]="userSession.isPermissions(link.subUrl)"
                    [ngClass]="{ 'active': link.url === activeUrl }"   *ngIf="link.subMenuLinks">
                  <span>{{ link.label }}</span>
                  <mat-menu #subMenu yPosition="below" [overlapTrigger]="false">
                    <button mat-menu-item class="dropdown-item" *ngFor="let subLink of link.subMenuLinks" [routerLink]=[subLink.url]  >{{ subLink.label }}</button>
                  </mat-menu>
                </li>
              </ng-container>
            </ul>
          </div>
        </nav>
      </div>
    </header>
    <div id="content">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
