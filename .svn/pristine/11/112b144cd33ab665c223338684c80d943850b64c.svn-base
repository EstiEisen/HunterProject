<div class="d-flex justify-content-between">
  <div>
    <p class="mb-5 title">מעקב שגויים - לפי עובד</p>
  </div>
  <div class="DivSelect">
    <app-employers-select2 (changeEmployerEvent)="setEmployer($event)" class="selectEmployer"></app-employers-select2>
    <mat-form-field class="ml-3">
      <mat-select placeholder="בחר שנה" [(ngModel)]="selectedYearValue" (selectionChange)="SearchYear($event.value)">
        <mat-option [value]="currentYear">{{ currentYear }}</mat-option>
        <mat-option [value]="currentYear - 1">{{ currentYear - 1 }}</mat-option>
        <mat-option [value]="currentYear - 2">{{ currentYear - 2 }}</mat-option>
        <mat-option [value]="currentYear - 3">{{ currentYear - 3 }}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
</div>



<div class="data-table  container-fluid">
  <div class="table-actions">
    <div class="row y-1">
      <div class="col-md-4">
        <select2 class="w-100" [data]="employees" [options]="select2Options" (valueChanged)="setSearch('employeeID', $event.value)"
          #select2></select2>
      </div>
      <div class="col-md-1 col-sm-12">
        <button type="button" class="btn btn-outline-dark" (click)="OpenFilter()">סנן</button>
      </div>
       <!-- <div class="col-md-1 col-sm-12" *ngIf="checklist.length>0">
        <button type="button" class="btn btn-outline-dark" (click)="SendApplications()">צור פנייה</button>
      </div> -->

    </div>
    <div>
      <div class="row" style="position: relative;">
      <div *ngIf="FilterBlockView" class="row arrow-up"></div></div>
      <div class="col-md-6 FilterBlock" *ngIf="FilterBlockView">
        <div class="row">
          <div class="col-md-12">
            <mat-form-field class="margin-field">
              <mat-select placeholder="בחר סטטוס" [(ngModel)]="searchCriteria['statusId']" (selectionChange)="searchselect()">
                <mat-option [value]="-1">הכל</mat-option>
                <!--<mat-option value="successful">נפרעו</mat-option>-->
                <!--<mat-option value="partial">נפרעו חלקית</mat-option>-->
                <!--<mat-option value="failed">לא נפרעו</mat-option>-->
                <mat-option *ngFor="let status of statuses" [value]="status.id">{{ status.text }}</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="margin-field">
              <mat-select placeholder="בחר סוג מוצר" [(ngModel)]="searchCriteria['productTypeId']" (selectionChange)="searchselect()">
                <mat-option [value]="-1">הכל</mat-option>
                <mat-option *ngFor="let product of products" [value]="product.id">{{ product.text }}</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="margin-field">
              <mat-select placeholder="בחר חודש" [(value)]="selectedMonthValue" (selectionChange)="setMonths($event.value)">
                <mat-option [value]="-1">כל החודשים</mat-option>
                <mat-option *ngFor="let month of months; let i = index" [value]="i + 1">{{ month }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="col-md-8">
            <select2 [data]="manufacturers" [value]="searchCriteria['manufacturerId']" [options]="select2Options" (valueChanged)="setSearch('manufacturerId', $event.value)"></select2>

            <!--<mat-form-field class="ml-3">-->
            <!--<mat-select placeholder="בחר חברה מנהלת" [(ngModel)]="searchCriteria['manufacturerID']" (selectionChange)="search()">-->
            <!--<mat-option [value]="-1">הכל</mat-option>-->
            <!--<mat-option *ngFor="let manufacturer of manufacturers" [value]="manufacturer.id">{{ manufacturer.text }}</mat-option>-->
            <!--</mat-select>-->
            <!--</mat-form-field>-->


          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <button type="button" class="btn btn-light" (click)="ClearAll()" style="color:#3079ed; float:left">נקה הכל</button>
          </div>
        </div>
      </div>
      <!--<mat-form-field class="ml-3">-->
      <!--<input matInput placeholder="חיפוש" type="text" [(ngModel)]="searchCriteria['q']" (keyup)="search($event.keyCode)">-->
      <!--<i matSuffix class="fa fa-search"></i>-->
      <!--</mat-form-field>-->



      <!-- <select2 class="" [value]="selectedValue" [data]="fileCodes" [options]="select2Options" (valueChanged)="setSearch('fileCodeId', $event.value)" #select2></select2> -->

    </div>
    <!-- <div class="mt-3 mb-3">
      <mat-slide-toggle [(ngModel)]="searchCriteria['showNegative']" color="primary" (change)="newSearch()">{{ searchCriteria['showNegative'] ? 'חיובי' : 'שלילי' }}</mat-slide-toggle>
    </div> -->
  </div>
  <table class="table table-bordered table-striped data-table">
    <thead>
      <tr>
        <!-- <th>
          <mat-checkbox type="checkbox" [(ngModel)]="checkBoxValue" [checked]="checkBoxValue" (change)="clearSelectAllIndexList()"></mat-checkbox>
        </th> -->
        <th>שם עובד</th>
        <th>תעודת זהות</th>
        <!-- <th>נושא הפניה</th> -->
        <th>גורם מטפל</th>
        <th>חודש שכר</th>
        <th>חברה מנהלת</th>
        <th>סוג מוצר</th>
        <th>סכום</th>
        <th>תאריך יצירת הפניה</th>
        <th>תאריך עידכון אחרון</th>
         <th>סטטוס</th>
         <th>סטטוס פניה</th> 
       <th>מידע נוסף</th>
      <th>שלח פניה</th>
        <th>הערות</th>

        <!-- <th></th> -->
      </tr>
    </thead>
    <tbody>
      <tr *ngIf="items.length== 0">
    
        <td colspan="14" style="text-align:center; background-color: #eceeef; color: #0c0c0c;
	width: 100%">

          לא נמצאו נתונים
        </td>
      </tr>
      <tr  class=" overTr" *ngFor="let item of items" >
         <!-- <td>
          <mat-checkbox type="checkbox" [checked]="checkBoxValue" (change)="IndexList(item.id)" class="checkbox"></mat-checkbox>
        </td> -->
        <td >{{ item.employee.firstName + ' ' + item.employee.lastName }}</td>
        <td >{{ item.employee.identityNumber }}</td>
        <!-- <td (click)="openDetailsDialog(item)">{{ item.ApplicationsSubject }}</td> -->
        <td>{{item.treatmentFactor}}</td>
        <td >{{item.dateMonthPay | date: 'MM/yyyy'}}</td>
        <td>{{item.product.manufacturer.name}}</td>
        <td>{{getEnumLabel(item.product.productType,'productType')}}</td>
        <td>{{item.SumTotal | number}}</td>
        <td>{{item.ApplicationCreatedAt | date: 'dd/MM/yyyy'}}</td>
        <td>{{item.ApplicationUpdatedAt | date: 'dd/MM/yyyy'}}</td>
        <td>{{getEnumLabel(item.status,'status')}}</td>
         <td  (click)="openDetailsDialog(item)" class="text-center">
           <span class="badge" [ngClass]="{ 'badge-success': item.IntApplicationStatus === 1 , 'badge-warning':
        item.IntApplicationStatus === 4, 'badge-danger': item.IntApplicationStatus === 3, 'badge-info': item.IntApplicationStatus == 2, 'badge-default': item.IntApplicationStatus == 0 }">
        {{item.ApplicationStatus}}</span> 
        </td> 

         <td  class="text-center grey-color">
          <i class="fa fa-info-circle" (click)="openDetailsDialog(item)"></i>
     </td>
           <td  class="text-center grey-color pointer">
    <i class="fa fa-envelope-o fa-lg icon-background2" (click)="openDetailsDialog(item,true)" matTooltip="לחץ לשליחת פנייה" matTooltipPosition="above"
       [matTooltipClass]="'mytooltip'"  aria-hidden="true"></i></td>
      <td class="text-center grey-color">
          <i class="fa fa-comment" (click)="openCommentDialog(item,false)" [title]="item.Comments"  [ngStyle]="{'color':item.Comments!='' ? 'green' : '' }"></i>
        </td>
         <!-- <td class="text-center row-actions">
        <i class="fa fa-exclamation-circle" (click)="openDetailsDialog(item)"></i>
      </td>  -->
      </tr>
    </tbody>
  </table>
  <app-pagination [data]="paginationData"  *ngIf="items.length > 0"></app-pagination>
</div>