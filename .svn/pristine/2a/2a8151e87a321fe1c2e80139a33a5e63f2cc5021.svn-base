<form id="processUploadForm" #processForm="ngForm" class="container py-3">
    
  <div class="align-items-center  upload-step-title">


<ng-container *ngIf="Neg&&activeUploadStep==2; then thenBlock; else elseBlock"></ng-container>
<ng-template #thenBlock>
    <div class="row">
    <p class="h3 NegTitle">העלאת תהליך שלילי</p>
    </div>
    <p class="SumHeader">לבקשת החזרים כספייםמהקופות יש להעלות קובץ בפורמט XML שלילי אשר מופק מתוכנת השכר.
    </p>
     <p class="SumHeader">קובץ זה יועבר לקופות על מנת להשיב את הכספים לחשבונכם.
</ng-template>
<ng-template #elseBlock>
    <p class="h3" [ngClass]="{ 'text-center': activeUploadStep !== 2 }">{{ getTitle() }}</p>
    <p class="SumHeader" *ngIf="activeUploadStep==2">במסך זה הינך נדרש לבצע טעינת נתונים מתוך קובץ XML</p>
</ng-template>

  <!-- <div  *ngIf="Neg&&activeUploadStep==2; then thenBlock; else elseBlock">
    <div class="row">
    <p class="h3 NegTitle">העלאת תהליך שלילי</p>
    </div>
    <p class="SumHeader">לבקשת החזרים כספייםמהקופות יש להעלות קובץ בפורמט XML שלילי אשר מופק מתוכנת השכר.
    </p>
     <p class="SumHeader">קובץ זה יועבר לקופות על מנת להשיב את הכספים לחשבונכם.
    </div>
   
    <div *ne="!Neg||"> 
    <p class="h3" [ngClass]="{ 'text-center': activeUploadStep !== 2 }">{{ getTitle() }}</p>
    <p class="SumHeader" *ngIf="activeUploadStep==2">במסך זה הינך נדרש לבצע טעינת נתונים מתוך קובץ XML</p>
    </div>-->
  </div>
  
  <div *ngIf="activeUploadStep === 1">
    <div class="row justify-content-between mb-3 mt-5">
      <!-- <i class="fa fa-info-circle fa-lg icon-background2"   matTooltip="בשדה זה ניתן להזין מלל חופשי אשר בתווסף לצורך זיהוי התהליך" matTooltipPosition="above"
       [matTooltipClass]="'mytooltip'"
      >
       </i> -->
     <div class="col-12 col-sm ml-5">
      <mat-form-field class="col-12 col-sm ml-5 fieldform">
        <input matInput name="addToProcessName" type="text" placeholder="שם תהליך" [(ngModel)]="process.addToProcessName">
      </mat-form-field>
      
       <p class="ButTooltip">בשדה זה ניתן להזין מלל חופשי אשר בתווסף לצורך זיהוי התהליך</p>
     </div>
   
      <div class="col-12 col-sm d-flex align-items-center">
        <select2 class="w-100"  [value]='EmployerID'  [data]="employersselect2" [options]="select2Options" (valueChanged)="changeEmployer($event.value)"
          #select2></select2>
      </div>
      <!-- <mat-form-field class="col-12 col-sm mr-5">
        <mat-select name="employer" placeholder="שם מעסיק" [(ngModel)]="process.employer.id"  [required]="true">
          <mat-option *ngFor="let employer of employers" [value]="employer.id">{{ employer.name }}</mat-option>
        </mat-select>
        <mat-error>יש לבחור מעסיק.</mat-error>
      </mat-form-field> -->
    </div>
    <div class="row justify-content-between my-4">
      <mat-form-field class="col-12 col-sm ml-5">
        <mat-select name="month" placeholder="בחר חודש" [(ngModel)]="process.month" #monthSelect="ngModel" [required]="true">
           <mat-option *ngFor="let month of months; let i = index" [value]="i + 1">{{ month }}</mat-option> 
        </mat-select>
        <mat-error>יש לבחור חודש.</mat-error>
      </mat-form-field>
      <mat-form-field class="col-12 col-sm">
        <mat-select name="year" placeholder="בחר שנה" [(ngModel)]="process.year" #yearSelect="ngModel" [required]="true">
          <mat-option [value]="currentYear">{{ currentYear }}</mat-option>
          <mat-option [value]="currentYear - 1">{{ currentYear - 1 }}</mat-option>
           <mat-option [value]="currentYear - 2">{{ currentYear - 2 }}</mat-option>
          <mat-option [value]="currentYear - 3">{{ currentYear - 3 }}</mat-option>
        </mat-select>
        <mat-error>יש לבחור שנה.</mat-error>
      </mat-form-field>
    </div>

  </div>

  <!-- <div class="narrow-width" *ngIf="activeUploadStep === 2">
    <mat-spinner class="mr-auto ml-auto mb-3" *ngIf="spin"></mat-spinner>
    <div id="selectFileContainer" [ngClass]="{ 'uploaded': paymentsFile }" ng2FileDrop (ng2FileDropFileAccepted)="setFile($event.acceptedFile)">
      <span id="removeUploadedFile" (click)="removeFile()" *ngIf="paymentsFile">
          <i class="fa fa-times"></i>
      </span>
      <label class="pointer" *ngIf="!paymentsFile" (change)="setFile($event.target.files[0])">
        <img src="/assets/img/icons/cloud-backup.svg" class="mb-1 icon-lg">
        <p class="h5 grey-color">בחר קובץ להעלאה</p>
        <p class="h6 grey-color">או גרור קבצים לכאן</p>
        <input type="file">
      </label>
      <div id="fileUploadedContainer" class="text-center" *ngIf="paymentsFile">
        <i class="fa fa-check-circle-o fa-4x"></i>
        <p *ngIf="paymentsFile" class="bold word-break w-75 mx-auto">{{ paymentsFile.name }}</p>
      </div>
    </div>
    <p class="alert alert-danger" *ngIf="fileTypeError">יש להעלות קבצי XML בלבד.</p>
    <p class="alert alert-danger" *ngIf="noFileError">יש להעלות קובץ.</p>
    <!-- <p class="bold text-center mt-3">
      <span class="grey-color">ליצירת תהליך ידני</span>
      <span class="link">לחץ כאן</span>
    </p> */
  </div> -->


  <div class="narrow-width" *ngIf="activeUploadStep === 2">
    <mat-spinner class="mr-auto ml-auto mb-3" *ngIf="spin"></mat-spinner>
    <file-drop class="selectFileContainer" [ngClass]="{ 'uploaded': paymentsFile }" ng2FileDrop (onFileDrop)="GetFileFromDrop($event)">

    
  
    <span id="removeUploadedFile" (click)="removeFile()" *ngIf="paymentsFile">
      <i class="fa fa-times"></i>
  </span>
  <label class="pointer" *ngIf="!paymentsFile" (change)="setFile($event.target.files[0])" >
    <img src="/assets/img/icons/cloud-backup.svg" class="mb-1 icon-lg">
    <p class="h5 grey-color">בחר קובץ להעלאה</p>
    <p class="h6 grey-color">או גרור קבצים לכאן</p>
    <input type="file">
  </label>
  <div id="fileUploadedContainer" class="text-center" *ngIf="paymentsFile">
    <i class="fa fa-check-circle-o fa-4x"></i>
    <p *ngIf="paymentsFile" class="bold word-break w-75 mx-auto">{{ paymentsFile.name }}</p>
  </div>
    </file-drop>
    <p class="alert alert-danger" *ngIf="fileTypeError">יש להעלות קבצי XML בלבד.</p>
    <p class="alert alert-danger" *ngIf="noFileError">יש להעלות קובץ.</p>
    <!-- <p class="bold text-center mt-3">
      <span class="grey-color">ליצירת תהליך ידני</span>
      <span class="link">לחץ כאן</span>
    </p> -->
  </div>
  <div class="row">
  <ng-container *ngIf="activeUploadStep === 3">
    <p class="h4 text-center col-md-12">
       <span class="grey-color">לנוחיותך ניתן כעת לצאת מהמערכת</span>

    </p>
       <p class="h4 text-center col-md-12">
      <span class="grey-color">{{ !isPaymentTransferred ? 'ליציאה וקבלת הנחיית תשלום במייל ' : 'ליציאה עדכון על סיום הטעינה במייל' }}</span>
      <span class="bold link pointer" (click)="openTransitionDialog()">לחץ כאן</span>
    </p>
    <p class="h4 mb-5 text-center col-md-12 grey-color">{{ !isPaymentTransferred ? 'ניתן להמתין לסיום הטעינה ולהורדת והורדת הנחיית התשלום' :
       'ניתן להמתין לסיום הטעינה ולעבור לשידור נתונים' }}</p>
    <div class="col col-md-6 mx-auto">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      <a class="float-sm-left bold link pointer" routerLink="/dashboard" >
      <i class="float-sm-left fa fa-chevron-left chevron"></i>עבור לדף הבית</a>
    </div>
        <p class="h4 text-center col-md-12 mt-4" *ngIf="!HaveNegativeProcess">
      <span class="grey-color">במידה וקימות בקשות להחזר כספי מקופות </span>
      <span class="redlink pointer" (click)="KeepHaveNegativeProcess()">לחץ כאן</span>
    </p>
      <p class="h4 text-center col-md-12 mt-4" *ngIf="HaveNegativeProcess">
      <i class="fa fa-check NegativeProcess"  aria-hidden="true"></i>
      <span class="grey-color">לאחר שידור תהליך זה ,תועבר לטעינת בקשות להחזרים מקופות </span>

    </p>
  </ng-container>
 </div>

<div class="d-flex justify-content-between mt-5">
        <div>
  <i class="fa fa-chevron-right fa-2x background3" *ngIf="activeUploadStep === 2" (click)="activeUploadStep = activeUploadStep - 1;EmployerID=-1;"
    matTooltip="חזור" matTooltipPosition="above"
       [matTooltipClass]="'mytooltip'"
    ><span class="spani">חזור</span></i>
        </div>
        <div *ngIf="activeUploadStep < 3">
          <button type="submit" class="btn btn-primary" (click)="setActiveUploadStep(activeUploadStep + 1, processForm)">המשך</button> 
        </div>
    </div>

  

  
  
</form>